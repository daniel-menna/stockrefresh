checks for fct_stocks:
  # Check fails when company_id, Date, value is missing or
  # when the data type of those columns is other than specified
  - schema:
      fail:
        when required column missing: 
          [company_id, datetime_id, value]
        when wrong column type:
          company_id: string
          datetime_id: string
          value: float64
  # Check fails when NULL values in the column
  - missing_count(company_id, datetime_id) = 0:
      name: All stocks have a value
  # Check fails when the value of any stocks is negative
  - failed rows:
      name: All stocks have a positive total amount
      fail query: |
        SELECT company_id, datatime_id, value
        FROM fct_invoices
        WHERE value < 0