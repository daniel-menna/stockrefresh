{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2024-08-26T14:20:50.404572Z", "invocation_id": "4d13d7bc-6c98-4eda-92dc-b1e082c4ce6d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-26T14:20:39.972325Z", "completed_at": "2024-08-26T14:20:39.986024Z"}, {"name": "execute", "started_at": "2024-08-26T14:20:39.986327Z", "completed_at": "2024-08-26T14:20:43.652867Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6819911003112793, "adapter_response": {"_message": "CREATE TABLE (11.0 rows, 671.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 11, "bytes_processed": 671, "bytes_billed": 10485760, "location": "US", "project_id": "stockprice-433416", "job_id": "858e2a93-997d-4071-a082-48f77bbf7d42", "slot_ms": 6057}, "message": "CREATE TABLE (11.0 rows, 671.0 Bytes processed)", "failures": null, "unique_id": "model.stock.dim_company", "compiled": true, "compiled_code": "-- Create the dimension table\nWITH companies_cte AS (\n\tSELECT DISTINCT\n\t    simbolo as company_id,\n\t    zip AS zip_code,\n\t\tcountry,\n\t\tindustry,\n\t\tenterpriseValue as valuation\n\tFROM `stockprice-433416`.`stock`.`raw_companies`\n\tWHERE simbolo IS NOT NULL\n)\nSELECT\n    *\nFROM companies_cte", "relation_name": "`stockprice-433416`.`stock`.`dim_company`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-26T14:20:43.655833Z", "completed_at": "2024-08-26T14:20:43.658481Z"}, {"name": "execute", "started_at": "2024-08-26T14:20:43.658684Z", "completed_at": "2024-08-26T14:20:46.730061Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.0748379230499268, "adapter_response": {"_message": "CREATE TABLE (252.0 rows, 21.7 KiB processed)", "code": "CREATE TABLE", "rows_affected": 252, "bytes_processed": 22176, "bytes_billed": 10485760, "location": "US", "project_id": "stockprice-433416", "job_id": "5dcc95e8-ddb9-4e1c-a4ce-4c14862ff754", "slot_ms": 6286}, "message": "CREATE TABLE (252.0 rows, 21.7 KiB processed)", "failures": null, "unique_id": "model.stock.dim_datetime", "compiled": true, "compiled_code": "-- Crie uma CTE para extrair componentes de data e hora como strings\nWITH datetime_cte AS (\n  SELECT DISTINCT\n    CAST(Date AS STRING) AS datetime_id,\n    FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', Date) AS date_part\n  FROM `stockprice-433416`.`stock`.`raw_stocks`\n  WHERE Date IS NOT NULL\n)\n\nSELECT\n  datetime_id,\n  CAST(date_part AS DATETIME) AS datetime,\n  SUBSTR(date_part, 9, 2) AS day,\n  SUBSTR(date_part, 6, 2) AS month,\n  SUBSTR(date_part, 1, 4) AS year,\n  SUBSTR(date_part, 12, 2) AS hour,\n  SUBSTR(date_part, 15, 2) AS minute,\n  EXTRACT(DAYOFWEEK FROM TIMESTAMP(date_part)) AS weekday\nFROM datetime_cte", "relation_name": "`stockprice-433416`.`stock`.`dim_datetime`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-26T14:20:46.734185Z", "completed_at": "2024-08-26T14:20:46.744599Z"}, {"name": "execute", "started_at": "2024-08-26T14:20:46.746271Z", "completed_at": "2024-08-26T14:20:50.399801Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6664321422576904, "adapter_response": {"_message": "CREATE TABLE (2.8k rows, 65.0 KiB processed)", "code": "CREATE TABLE", "rows_affected": 2772, "bytes_processed": 66592, "bytes_billed": 31457280, "location": "US", "project_id": "stockprice-433416", "job_id": "b5ecfe9f-edce-4e59-a851-d3d2acb79436", "slot_ms": 6287}, "message": "CREATE TABLE (2.8k rows, 65.0 KiB processed)", "failures": null, "unique_id": "model.stock.fct_stock", "compiled": true, "compiled_code": "-- Crie a tabela fato juntando as chaves relevantes da tabela de dimens\u00e3o\nWITH fct_stock_cte AS (\n    SELECT\n        simbolo AS company_id,\n        CAST(Date AS STRING) AS datetime_id,\n        Close as value\n    FROM `stockprice-433416`.`stock`.`raw_stocks`\n)\n\nSELECT\n    dc.company_id,\n    dt.datetime_id,\n    fs.value\nFROM fct_stock_cte fs\nINNER JOIN `stockprice-433416`.`stock`.`dim_datetime` dt ON fs.datetime_id = dt.datetime_id\nINNER JOIN `stockprice-433416`.`stock`.`dim_company` dc ON fs.company_id = dc.company_id", "relation_name": "`stockprice-433416`.`stock`.`fct_stock`"}], "elapsed_time": 11.860952138900757, "args": {"quiet": false, "which": "run", "static_parser": true, "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true, "favor_state": false, "print": true, "use_colors": true, "write_json": true, "log_level_file": "debug", "require_resource_names_without_spaces": false, "empty": false, "vars": {}, "project_dir": "/Users/danielmenna/sandbox/stock-refresh/include/dbt", "populate_cache": true, "exclude": [], "cache_selected_only": false, "show_resource_report": false, "indirect_selection": "eager", "select": [], "partial_parse": true, "defer": false, "introspect": true, "strict_mode": false, "log_path": "/Users/danielmenna/sandbox/stock-refresh/include/dbt/logs", "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "debug", "log_file_max_bytes": 10485760, "use_colors_file": true, "log_level": "info", "log_format": "default", "printer_width": 80, "profiles_dir": "/Users/danielmenna/sandbox/stock-refresh/include/dbt", "send_anonymous_usage_stats": true, "version_check": true, "macro_debugging": false, "enable_legacy_logger": false, "invocation_command": "dbt run", "warn_error_options": {"include": [], "exclude": []}}}