{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2024-08-26T17:43:52.374650Z", "invocation_id": "2692659c-3b5b-42ea-a441-0890101e1096", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-26T17:43:38.495845Z", "completed_at": "2024-08-26T17:43:38.506673Z"}, {"name": "execute", "started_at": "2024-08-26T17:43:38.507115Z", "completed_at": "2024-08-26T17:43:42.279211Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.7848708629608154, "adapter_response": {"_message": "CREATE TABLE (11.0 rows, 885.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 11, "bytes_processed": 885, "bytes_billed": 10485760, "location": "US", "project_id": "stockprice-433416", "job_id": "cdabee22-7434-4795-b8cb-5859fdea6f92", "slot_ms": 5274}, "message": "CREATE TABLE (11.0 rows, 885.0 Bytes processed)", "failures": null, "unique_id": "model.stock.dim_company", "compiled": true, "compiled_code": "-- Create the dimension table\nWITH companies_cte AS (\n\tSELECT DISTINCT\n\t    simbolo as company_id,\n\t\tshortName as company_name,\n\t    zip AS zip_code,\n\t\tcountry,\n\t\tindustry,\n\t\tenterpriseValue as valuation\n\tFROM `stockprice-433416`.`stock`.`raw_companies`\n\tWHERE simbolo IS NOT NULL\n)\nSELECT\n    *\nFROM companies_cte", "relation_name": "`stockprice-433416`.`stock`.`dim_company`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-26T17:43:42.283463Z", "completed_at": "2024-08-26T17:43:42.286692Z"}, {"name": "execute", "started_at": "2024-08-26T17:43:42.286979Z", "completed_at": "2024-08-26T17:43:45.704264Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.4216861724853516, "adapter_response": {"_message": "CREATE TABLE (5.0 rows, 440.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 5, "bytes_processed": 440, "bytes_billed": 10485760, "location": "US", "project_id": "stockprice-433416", "job_id": "c18849ed-3a79-4860-bfcb-da9da016adf2", "slot_ms": 4589}, "message": "CREATE TABLE (5.0 rows, 440.0 Bytes processed)", "failures": null, "unique_id": "model.stock.dim_datetime", "compiled": true, "compiled_code": "-- Crie uma CTE para extrair componentes de data e hora como strings\nWITH datetime_cte AS (\n  SELECT DISTINCT\n    CAST(Date AS STRING) AS datetime_id,\n    FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', Date) AS date_part\n  FROM `stockprice-433416`.`stock`.`raw_stocks`\n  WHERE Date IS NOT NULL\n)\n\nSELECT\n  datetime_id,\n  CAST(date_part AS DATETIME) AS datetime,\n  SUBSTR(date_part, 9, 2) AS day,\n  SUBSTR(date_part, 6, 2) AS month,\n  SUBSTR(date_part, 1, 4) AS year,\n  SUBSTR(date_part, 12, 2) AS hour,\n  SUBSTR(date_part, 15, 2) AS minute,\n  EXTRACT(DAYOFWEEK FROM TIMESTAMP(date_part)) AS weekday\nFROM datetime_cte", "relation_name": "`stockprice-433416`.`stock`.`dim_datetime`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-26T17:43:45.709869Z", "completed_at": "2024-08-26T17:43:45.715687Z"}, {"name": "execute", "started_at": "2024-08-26T17:43:45.716157Z", "completed_at": "2024-08-26T17:43:48.680283Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.9713358879089355, "adapter_response": {"_message": "CREATE TABLE (11.0 rows, 366.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 11, "bytes_processed": 366, "bytes_billed": 10485760, "location": "US", "project_id": "stockprice-433416", "job_id": "ce252a65-27dd-41a1-b56a-c077d0d7f53d", "slot_ms": 4459}, "message": "CREATE TABLE (11.0 rows, 366.0 Bytes processed)", "failures": null, "unique_id": "model.stock.report_top_companies", "compiled": true, "compiled_code": "with top_companies as (\n    SELECT company_id as Symbol,\n        company_name as Name,\n        valuation as Value\n    FROM `stockprice-433416`.`stock`.`dim_company`\n\tORDER BY valuation DESC\n)\nSELECT\n    *\nFROM top_companies", "relation_name": "`stockprice-433416`.`stock`.`report_top_companies`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-26T17:43:48.686237Z", "completed_at": "2024-08-26T17:43:48.692292Z"}, {"name": "execute", "started_at": "2024-08-26T17:43:48.692790Z", "completed_at": "2024-08-26T17:43:52.368898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6838250160217285, "adapter_response": {"_message": "CREATE TABLE (55.0 rows, 1.4 KiB processed)", "code": "CREATE TABLE", "rows_affected": 55, "bytes_processed": 1384, "bytes_billed": 31457280, "location": "US", "project_id": "stockprice-433416", "job_id": "507a9948-8dcd-4d7a-977d-958a49a33131", "slot_ms": 6264}, "message": "CREATE TABLE (55.0 rows, 1.4 KiB processed)", "failures": null, "unique_id": "model.stock.fct_stock", "compiled": true, "compiled_code": "-- Crie a tabela fato juntando as chaves relevantes da tabela de dimens\u00e3o\nWITH fct_stock_cte AS (\n    SELECT\n        simbolo AS company_id,\n        CAST(Date AS STRING) AS datetime_id,\n        Close as value\n    FROM `stockprice-433416`.`stock`.`raw_stocks`\n)\n\nSELECT\n    dc.company_id,\n    dt.datetime_id,\n    fs.value\nFROM fct_stock_cte fs\nINNER JOIN `stockprice-433416`.`stock`.`dim_datetime` dt ON fs.datetime_id = dt.datetime_id\nINNER JOIN `stockprice-433416`.`stock`.`dim_company` dc ON fs.company_id = dc.company_id", "relation_name": "`stockprice-433416`.`stock`.`fct_stock`"}], "elapsed_time": 15.229557991027832, "args": {"require_explicit_package_overrides_for_builtin_materializations": true, "strict_mode": false, "log_level": "info", "which": "run", "partial_parse": true, "quiet": false, "show_resource_report": false, "defer": false, "select": [], "static_parser": true, "cache_selected_only": false, "empty": false, "favor_state": false, "project_dir": "/Users/danielmenna/sandbox/stock-refresh/include/dbt", "invocation_command": "dbt run", "log_format": "default", "exclude": [], "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "require_resource_names_without_spaces": false, "log_path": "/Users/danielmenna/sandbox/stock-refresh/include/dbt/logs", "enable_legacy_logger": false, "warn_error_options": {"include": [], "exclude": []}, "partial_parse_file_diff": true, "indirect_selection": "eager", "version_check": true, "log_level_file": "debug", "use_colors_file": true, "log_format_file": "debug", "introspect": true, "profiles_dir": "/Users/danielmenna/sandbox/stock-refresh/include/dbt", "vars": {}, "write_json": true, "macro_debugging": false, "printer_width": 80, "use_colors": true, "populate_cache": true, "print": true, "source_freshness_run_project_hooks": false}}