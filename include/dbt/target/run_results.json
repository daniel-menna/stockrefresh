{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2024-08-28T19:45:57.938910Z", "invocation_id": "ecfd8f23-1bb8-44d3-ab3e-e75d6b7d2217", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-28T19:45:32.660578Z", "completed_at": "2024-08-28T19:45:32.674906Z"}, {"name": "execute", "started_at": "2024-08-28T19:45:32.675300Z", "completed_at": "2024-08-28T19:45:36.660608Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.001377105712891, "adapter_response": {"_message": "CREATE TABLE (11.0 rows, 885.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 11, "bytes_processed": 885, "bytes_billed": 10485760, "location": "US", "project_id": "stockprice-433416", "job_id": "cbf2c6a8-5c0f-42d3-90ac-17b7a585b29f", "slot_ms": 12098}, "message": "CREATE TABLE (11.0 rows, 885.0 Bytes processed)", "failures": null, "unique_id": "model.stock.dim_company", "compiled": true, "compiled_code": "-- Create the dimension table\nWITH companies_cte AS (\n\tSELECT DISTINCT\n\t    symbol as company_id,\n\t\tshortName as company_name,\n\t    zip,\n\t\tcountry,\n\t\tindustry,\n\t\tenterpriseValue as valuation\n\tFROM `stockprice-433416`.`stock`.`raw_companies`\n\tWHERE symbol IS NOT NULL\n)\nSELECT\n    *\nFROM companies_cte", "relation_name": "`stockprice-433416`.`stock`.`dim_company`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-28T19:45:36.665472Z", "completed_at": "2024-08-28T19:45:36.669928Z"}, {"name": "execute", "started_at": "2024-08-28T19:45:36.670594Z", "completed_at": "2024-08-28T19:45:40.020397Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.355926036834717, "adapter_response": {"_message": "CREATE TABLE (65.0 rows, 5.6 KiB processed)", "code": "CREATE TABLE", "rows_affected": 65, "bytes_processed": 5720, "bytes_billed": 10485760, "location": "US", "project_id": "stockprice-433416", "job_id": "6ed31649-0706-4bcd-8fa2-b4f9ed7c8399", "slot_ms": 6666}, "message": "CREATE TABLE (65.0 rows, 5.6 KiB processed)", "failures": null, "unique_id": "model.stock.dim_datetime", "compiled": true, "compiled_code": "-- Crie uma CTE para extrair componentes de data e hora como strings\nWITH datetime_cte AS (\n  SELECT DISTINCT\n    CAST(Date AS STRING) AS datetime_id,\n    FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', Date) AS date_part\n  FROM `stockprice-433416`.`stock`.`raw_stocks`\n  WHERE Date IS NOT NULL\n)\n\nSELECT\n  datetime_id,\n  CAST(date_part AS DATETIME) AS datetime,\n  SUBSTR(date_part, 9, 2) AS day,\n  SUBSTR(date_part, 6, 2) AS month,\n  SUBSTR(date_part, 1, 4) AS year,\n  SUBSTR(date_part, 12, 2) AS hour,\n  SUBSTR(date_part, 15, 2) AS minute,\n  EXTRACT(DAYOFWEEK FROM TIMESTAMP(date_part)) AS weekday\nFROM datetime_cte", "relation_name": "`stockprice-433416`.`stock`.`dim_datetime`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-28T19:45:40.027282Z", "completed_at": "2024-08-28T19:45:40.033978Z"}, {"name": "execute", "started_at": "2024-08-28T19:45:40.034716Z", "completed_at": "2024-08-28T19:45:43.501644Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.475843906402588, "adapter_response": {"_message": "CREATE TABLE (11.0 rows, 269.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 11, "bytes_processed": 269, "bytes_billed": 10485760, "location": "US", "project_id": "stockprice-433416", "job_id": "2a425088-3eab-4bf4-88a2-286537f3e8fb", "slot_ms": 7498}, "message": "CREATE TABLE (11.0 rows, 269.0 Bytes processed)", "failures": null, "unique_id": "model.stock.dim_locals", "compiled": true, "compiled_code": "-- Create the dimension table\nWITH localization_cte AS (\n    SELECT DISTINCT\n        symbol AS company_id,\n        CAST(lat AS STRING) AS lat,\n        CAST(long AS STRING) AS long\n    FROM `stockprice-433416`.`stock`.`raw_localization`\n    WHERE symbol IS NOT NULL\n)\nSELECT\n    *\nFROM localization_cte", "relation_name": "`stockprice-433416`.`stock`.`dim_locals`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-28T19:45:43.508243Z", "completed_at": "2024-08-28T19:45:43.515787Z"}, {"name": "execute", "started_at": "2024-08-28T19:45:43.516560Z", "completed_at": "2024-08-28T19:45:46.969760Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.4628777503967285, "adapter_response": {"_message": "CREATE TABLE (11.0 rows, 366.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 11, "bytes_processed": 366, "bytes_billed": 10485760, "location": "US", "project_id": "stockprice-433416", "job_id": "692b9cb2-c9bf-4eb8-bb78-138c48103ce5", "slot_ms": 234}, "message": "CREATE TABLE (11.0 rows, 366.0 Bytes processed)", "failures": null, "unique_id": "model.stock.report_top_companies", "compiled": true, "compiled_code": "with top_companies as (\n    SELECT company_id as Symbol,\n        company_name as Name,\n        valuation as Value\n    FROM `stockprice-433416`.`stock`.`dim_company`\n)\nSELECT\n    *\nFROM top_companies\nORDER BY Value DESC", "relation_name": "`stockprice-433416`.`stock`.`report_top_companies`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-28T19:45:46.975648Z", "completed_at": "2024-08-28T19:45:46.983245Z"}, {"name": "execute", "started_at": "2024-08-28T19:45:46.983543Z", "completed_at": "2024-08-28T19:45:50.639320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6649599075317383, "adapter_response": {"_message": "CREATE TABLE (715.0 rows, 16.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 715, "bytes_processed": 17224, "bytes_billed": 31457280, "location": "US", "project_id": "stockprice-433416", "job_id": "b1ed476e-ba55-4ee4-9a9f-1dd184182447", "slot_ms": 7923}, "message": "CREATE TABLE (715.0 rows, 16.8 KiB processed)", "failures": null, "unique_id": "model.stock.fct_stock", "compiled": true, "compiled_code": "-- Crie a tabela fato juntando as chaves relevantes da tabela de dimens\u00e3o\nWITH fct_stock_cte AS (\n    SELECT\n        symbol AS company_id,\n        CAST(Date AS STRING) AS datetime_id,\n        Close as price\n    FROM `stockprice-433416`.`stock`.`raw_stocks`\n)\n\nSELECT\n    dc.company_id,\n    dt.datetime_id,\n    fs.price\nFROM fct_stock_cte fs\nINNER JOIN `stockprice-433416`.`stock`.`dim_datetime` dt ON fs.datetime_id = dt.datetime_id\nINNER JOIN `stockprice-433416`.`stock`.`dim_company` dc ON fs.company_id = dc.company_id", "relation_name": "`stockprice-433416`.`stock`.`fct_stock`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-28T19:45:50.645186Z", "completed_at": "2024-08-28T19:45:50.652552Z"}, {"name": "execute", "started_at": "2024-08-28T19:45:50.653551Z", "completed_at": "2024-08-28T19:45:54.332871Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.688936233520508, "adapter_response": {"_message": "CREATE TABLE (11.0 rows, 644.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 11, "bytes_processed": 644, "bytes_billed": 20971520, "location": "US", "project_id": "stockprice-433416", "job_id": "76ce693c-fcc2-4bd3-8b6d-de61ddfa1838", "slot_ms": 6880}, "message": "CREATE TABLE (11.0 rows, 644.0 Bytes processed)", "failures": null, "unique_id": "model.stock.report_companies_localization", "compiled": true, "compiled_code": "with companies_localization_cte as (\n    SELECT cmp.company_id as Symbol,\n        cmp.company_name as Name,\n        cmp.valuation as Value,\n        loc.lat as latitud,\n        loc.long as longitud\n    FROM `stockprice-433416`.`stock`.`dim_company` cmp\n    INNER JOIN `stockprice-433416`.`stock`.`dim_locals` loc\n    ON loc.company_id = cmp.company_id\n)\nSELECT\n    *\nFROM companies_localization_cte", "relation_name": "`stockprice-433416`.`stock`.`report_companies_localization`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-28T19:45:54.338581Z", "completed_at": "2024-08-28T19:45:54.345698Z"}, {"name": "execute", "started_at": "2024-08-28T19:45:54.346562Z", "completed_at": "2024-08-28T19:45:57.930875Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.5935919284820557, "adapter_response": {"_message": "CREATE TABLE (65.0 rows, 26.4 KiB processed)", "code": "CREATE TABLE", "rows_affected": 65, "bytes_processed": 27040, "bytes_billed": 10485760, "location": "US", "project_id": "stockprice-433416", "job_id": "cadaa664-c7b5-4450-8fcf-6508034a8f59", "slot_ms": 7308}, "message": "CREATE TABLE (65.0 rows, 26.4 KiB processed)", "failures": null, "unique_id": "model.stock.report_stockprice_per_customer", "compiled": true, "compiled_code": "with stockprice as(\n    SELECT \n    datetime_id as Date,\n    MAX(CASE WHEN company_id = 'AAPL' THEN price ELSE NULL END) AS APPLE,\n    MAX(CASE WHEN company_id = 'GOOGL' THEN price ELSE NULL END) AS GOOGLE,\n    MAX(CASE WHEN company_id = 'AMZN' THEN price ELSE NULL END) AS AMAZON,\n    MAX(CASE WHEN company_id = 'META' THEN price ELSE NULL END) AS META,\n    MAX(CASE WHEN company_id = 'MSFT' THEN price ELSE NULL END) AS MICROSOFT,\n    MAX(CASE WHEN company_id = 'NVDA' THEN price ELSE NULL END) AS NVIDIA,\n    MAX(CASE WHEN company_id = 'DELL' THEN price ELSE NULL END) AS DELL,\n    MAX(CASE WHEN company_id = 'SAP' THEN price ELSE NULL END) AS SAP,\n    MAX(CASE WHEN company_id = 'CRM' THEN price ELSE NULL END) AS SALESFORCE,\n    MAX(CASE WHEN company_id = 'ORCL' THEN price ELSE NULL END) AS ORACLE,\n    MAX(CASE WHEN company_id = 'IBM' THEN price ELSE NULL END) AS IBM\nFROM \n    `stockprice-433416`.`stock`.`fct_stock`\nGROUP BY \n    datetime_id\n)\n\nSELECT\n    *\nFROM stockprice", "relation_name": "`stockprice-433416`.`stock`.`report_stockprice_per_customer`"}], "elapsed_time": 26.73563003540039, "args": {"profiles_dir": "/Users/danielmenna/sandbox/stock-refresh/include/dbt", "version_check": true, "show_resource_report": false, "print": true, "which": "run", "log_level": "info", "favor_state": false, "empty": false, "printer_width": 80, "send_anonymous_usage_stats": true, "enable_legacy_logger": false, "static_parser": true, "log_format": "default", "require_resource_names_without_spaces": false, "exclude": [], "log_path": "/Users/danielmenna/sandbox/stock-refresh/include/dbt/logs", "indirect_selection": "eager", "use_colors_file": true, "quiet": false, "select": [], "write_json": true, "cache_selected_only": false, "source_freshness_run_project_hooks": false, "partial_parse": true, "invocation_command": "dbt run", "log_format_file": "debug", "log_file_max_bytes": 10485760, "populate_cache": true, "use_colors": true, "defer": false, "vars": {}, "log_level_file": "debug", "strict_mode": false, "warn_error_options": {"include": [], "exclude": []}, "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse_file_diff": true, "project_dir": "/Users/danielmenna/sandbox/stock-refresh/include/dbt", "introspect": true, "macro_debugging": false}}